<!DOCTYPE html>
<div class="backbar" style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
  <button class="back" onclick="history.back()">‚Üê Back</button>
</div>
<html lang="en">
<head>
  <link rel="stylesheet" href="../ugly.css">
  <meta charset="UTF-8">
  <title>iMeet | GEAR HUB (HTML)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
  /* uses global theme */
    body { margin:0; font-family: Inter, system-ui, sans-serif; background: var(--bg); color: var(--text); }
    .center { min-height: 100vh; display: grid; place-items: center; }
  .glass { background: var(--card-bg); border:1px solid var(--sep-weak); backdrop-filter: blur(8px); border-radius: 24px; padding: 24px; width: 800px; }
  .input { width: 100%; padding: 10px; border-radius: 12px; border: 1px solid var(--sep-weak); background: var(--card-bg); color: var(--text); }
  .btn { padding:10px 14px; border-radius:12px; background: linear-gradient(90deg,var(--primary),var(--sea-top)); border: none; color:#fff; cursor:pointer; }
    .row { display:flex; gap:10px; align-items:center; }
  </style>
</head>
<body>
  <div class="center">
    <div class="glass">
      <h2>iMeet Live Class</h2>
      <div class="row">
        <input id="room" class="input" value="GEARHUB-CLASSROOM-1">
        <button class="btn" onclick="join()">Join Session</button>
      </div>
      <div id="meet" style="margin-top:12px; height:480px; background:black; border-radius:12px;"></div>
      <div class="row" style="justify-content:flex-end;margin-top:8px">
        <button class="btn" onclick="leave()">Leave</button>
      </div>
    </div>
  </div>

  <script>
    const ACTIVE_SESSION_KEY='gearhub_active_session'; const user=JSON.parse(localStorage.getItem(ACTIVE_SESSION_KEY)||'null'); if(!user) location.href='../arjun/login.html';
    let api=null;

    function join(){
      const roomName = document.getElementById('room').value.trim(); if(!roomName) return alert('Enter room name.');
      if(!window.JitsiMeetExternalAPI){ const script=document.createElement('script'); script.src='https://meet.jit.si/external_api.js'; script.onload=init; document.body.appendChild(script); }
      else init();
      function init(){
        if(api) api.dispose();
        api = new window.JitsiMeetExternalAPI('meet.jit.si', {
          roomName, width:'100%', height:480, parentNode: document.getElementById('meet'),
          userInfo: { displayName: user.name, email: user.email },
          configOverwrite: { startWithAudioMuted:true, prejoinPageEnabled:false },
          interfaceConfigOverwrite: { SHOW_JITSI_WATERMARK:false, SHOW_WATERMARK_FOR_GUESTS:false }
        });
        api.addEventListeners({ videoConferenceLeft: () => leave(), readyToClose: () => leave() });
      }
    }
    function leave(){ if(api){ api.dispose(); api=null; } }
  </script>
</body>
</html>
