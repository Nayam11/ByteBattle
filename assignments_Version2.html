<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Assignments | GEAR HUB (HTML)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root { --bg:#020617; --panel:rgba(15,23,42,0.6); --text:#F8FAFC; }
    body { margin:0; font-family: Inter, system-ui, sans-serif; background: var(--bg); color: var(--text); }
    .app { display:flex; height:100vh; }
    .aside { width:280px; background: rgba(15,23,42,0.4); backdrop-filter: blur(24px); border-right:1px solid rgba(255,255,255,0.06); display:flex; flex-direction:column; }
    .main { flex:1; display:flex; flex-direction:column; }
    .header { height:80px; display:flex; align-items:center; justify-content:space-between; padding:0 24px; border-bottom:1px solid rgba(255,255,255,0.08); background: rgba(2,6,23,0.6); backdrop-filter: blur(16px); position:sticky; top:0; }
    .content { flex:1; overflow:auto; padding:24px; }
    .glass { background: var(--panel); backdrop-filter: blur(24px); border:1px solid rgba(255,255,255,0.08); border-radius: 24px; box-shadow: 0 10px 40px -10px rgba(6,182,212,0.25); padding: 24px; }
    .row { display:flex; gap:16px; flex-wrap:wrap; }
    .card { flex:1; min-width:260px; }
    .input { width:100%; padding:10px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background: rgba(2,6,23,0.6); color:#fff; }
    .btn { padding:8px 12px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background: rgba(6,182,212,0.2); color:#fff; cursor:pointer; }
    .btn-primary { background: linear-gradient(90deg,#06b6d4,#3b82f6); border: none; }
    .chip { font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.06); }
  </style>
</head>
<body>
  <div class="app">
    <aside class="aside">
      <div style="padding:24px; display:flex; align-items:center; gap:12px;">
        <div style="width:40px;height:40px;background:linear-gradient(135deg,#06b6d4,#3b82f6);border-radius:12px;display:flex;align-items:center;justify-content:center;">‚¨¢</div>
        <div><div style="font-weight:700">GEAR HUB</div></div>
      </div>
      <nav style="padding:12px; overflow:auto">
        <button class="btn" onclick="location.href='dashboard.html'">üè† Dashboard</button>
        <button class="btn" onclick="location.href='assignments.html'">üìÑ Assignments</button>
      </nav>
      <div style="margin-top:auto;padding:16px"><button class="btn" onclick="logout()">Sign Out</button></div>
    </aside>

    <main class="main">
      <header class="header">
        <h2>Assignments</h2>
        <button id="createBtn" class="btn btn-primary" style="display:none" onclick="openCreate()">Create New</button>
      </header>

      <div class="content">
        <div id="assignGrid" class="row"></div>
      </div>
    </main>
  </div>

  <!-- Create Modal -->
  <div id="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center;">
    <div class="glass" style="width:400px">
      <h3>Create Assignment</h3>
      <input id="aTitle" class="input" placeholder="Title">
      <textarea id="aDesc" class="input" style="height:120px" placeholder="Description"></textarea>
      <input id="aDue" class="input" placeholder="Due Date (YYYY-MM-DD)">
      <div class="row" style="justify-content:flex-end">
        <button class="btn" onclick="closeCreate()">Cancel</button>
        <button class="btn btn-primary" onclick="saveAssignment()">Save</button>
      </div>
    </div>
  </div>

  <script>
    const ACTIVE_SESSION_KEY='gearhub_active_session', STORAGE_KEY='gearhub_assignments_global';
    let user = JSON.parse(localStorage.getItem(ACTIVE_SESSION_KEY) || 'null'); if(!user) location.href='login.html';
    function logout(){ localStorage.removeItem(ACTIVE_SESSION_KEY); location.href='login.html'; }
    if(user.role==='TEACHER') document.getElementById('createBtn').style.display='inline-block';

    let assignments = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    renderGrid();

    function renderGrid(){
      const grid = document.getElementById('assignGrid'); grid.innerHTML='';
      const visible = user.role==='TEACHER'?assignments:assignments.filter(a=>a.status==='active' || a.status==='draft');
      if(visible.length===0){ grid.innerHTML = `<div class="glass" style="flex:1;text-align:center;padding:40px;color:#94a3b8">No active assignments.</div>`; return; }
      visible.forEach(assign=>{
        const card = document.createElement('div'); card.className='glass card';
        card.innerHTML = `
          <div class="row" style="justify-content:space-between">
            <div class="chip">${assign.status}</div>
            <div class="chip">Due: ${assign.dueDate}</div>
          </div>
          <h3>${assign.title}</h3>
          <div style="color:#94a3b8">${assign.description}</div>
          <div class="row" style="margin-top:10px">
            ${user.role==='STUDENT' ? `<button class="btn">Upload</button>` : `<button class="btn">View Submissions</button>`}
          </div>`;
        grid.appendChild(card);
      });
    }

    function openCreate(){ document.getElementById('modal').style.display='flex'; }
    function closeCreate(){ document.getElementById('modal').style.display='none'; }
    function saveAssignment(){
      const title=aTitle.value.trim(), desc=aDesc.value.trim(), due=aDue.value.trim();
      if(!title || !desc || !due) return alert('Fill all fields.');
      const rec = { id: Date.now().toString(), title, description: desc, dueDate: due, classId:'', teacherId:user.id, status:'active' };
      const all = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); all.push(rec); localStorage.setItem(STORAGE_KEY, JSON.stringify(all));
      assignments.push(rec); renderGrid(); closeCreate();
    }
  </script>
</body>
</html>