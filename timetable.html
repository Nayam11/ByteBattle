<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Timetable | GEAR HUB (HTML)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root { --bg:#020617; --panel:rgba(15,23,42,0.6); --text:#F8FAFC; }
    body { margin:0; font-family: Inter, system-ui, sans-serif; background: var(--bg); color: var(--text); }
    .app { display:flex; height:100vh; }
    .aside { width:280px; background: rgba(15,23,42,0.4); backdrop-filter: blur(24px); border-right:1px solid rgba(255,255,255,0.06); display:flex; flex-direction:column; }
    .main { flex:1; display:flex; flex-direction:column; }
    .header { height:80px; display:flex; align-items:center; justify-content:space-between; padding:0 24px; border-bottom:1px solid rgba(255,255,255,0.08); background: rgba(2,6,23,0.6); backdrop-filter: blur(16px); position:sticky; top:0; }
    .content { flex:1; overflow:auto; padding:24px; }
    .glass { background: var(--panel); backdrop-filter: blur(24px); border:1px solid rgba(255,255,255,0.08); border-radius: 24px; box-shadow: 0 10px 40px -10px rgba(6,182,212,0.25); padding: 24px; }
    .nav-btn { width:100%; display:flex; gap:12px; align-items:center; padding:12px 16px; color:#cbd5e1; border-radius:16px; border:1px solid transparent; cursor:pointer; }
    .nav-btn:hover { background: rgba(255,255,255,0.06); color:#e2e8f0; }
    .row { display:flex; gap:16px; }
    .input { width: 100%; padding: 10px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.12); background: rgba(2,6,23,0.6); color: #fff; }
    .btn { padding:8px 12px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background: rgba(6,182,212,0.2); color:#fff; cursor:pointer; }
    .btn-primary { background: linear-gradient(90deg,#06b6d4,#3b82f6); border: none; }
    .grid { display:grid; grid-template-columns: 120px repeat(5, 1fr); border:1px solid rgba(255,255,255,0.08); border-radius:16px; overflow:hidden; }
    .cell { border-right:1px solid rgba(255,255,255,0.08); border-bottom:1px solid rgba(255,255,255,0.08); padding:8px; min-height:100px; position:relative; }
    .cell:last-child { border-right:none; }
    .header-cell { background: rgba(255,255,255,0.06); font-weight:700; text-align:center; }
    .slot { border:1px solid rgba(255,255,255,0.12); border-radius:10px; padding:8px; background: rgba(6,182,212,0.08); cursor:pointer; }
    .small { font-size:12px; color:#94a3b8; }
    .modal { position:fixed; inset:0; background: rgba(0,0,0,0.6); display:none; align-items:center; justify-content:center; }
    .modal-card { width:360px; background: var(--panel); border:1px solid rgba(255,255,255,0.1); border-radius:16px; padding:16px; }
    .chip { font-size:10px; padding:2px 6px; border-radius:10px; border:1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.06); }
  </style>
</head>
<body>
  <div class="app">
    <aside class="aside">
      <div style="padding:24px; display:flex; align-items:center; gap:12px;">
        <div style="width:40px;height:40px;background:linear-gradient(135deg,#06b6d4,#3b82f6);border-radius:12px;display:flex;align-items:center;justify-content:center;">‚¨¢</div>
        <div><div style="font-weight:700">GEAR HUB</div></div>
      </div>
      <nav style="padding:12px; overflow:auto">
        <button class="nav-btn" onclick="location.href='dashboard.html'">üè† Dashboard</button>
        <button class="nav-btn" onclick="location.href='notes.html'">üìí Study & Notes</button>
        <button class="nav-btn" onclick="location.href='timetable.html'">üìÜ Timetable</button>
        <button class="nav-btn" onclick="location.href='imeet.html'">üé• iMeet Live</button>
        <button class="nav-btn" onclick="location.href='pomodoro.html'">‚è±Ô∏è Focus Timer</button>
        <button class="nav-btn" onclick="location.href='games.html'">üéÆ Arcade Zone</button>
        <button class="nav-btn" onclick="location.href='chat.html'">üí¨ Collaboration</button>
        <button class="nav-btn" onclick="location.href='grades.html'">üìä Performance</button>
      </nav>
      <div style="margin-top:auto;padding:16px"><button class="btn" onclick="logout()">Sign Out</button></div>
    </aside>

    <main class="main">
      <header class="header">
        <h2>Weekly Schedule</h2>
        <button class="btn btn-primary" onclick="openModal()">+ Add Class</button>
      </header>

      <div class="content">
        <div class="glass">
          <div class="grid" id="grid"></div>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-card">
      <h3>Add Class</h3>
      <div class="row">
        <div class="col">
          <label class="small">Day</label>
          <select id="day" class="input">
            <option>Mon</option><option>Tue</option><option>Wed</option><option>Thu</option><option>Fri</option>
          </select>
        </div>
        <div class="col">
          <label class="small">Time</label>
          <select id="time" class="input">
            <option>09:00</option><option>10:00</option><option>11:00</option><option>12:00</option><option>13:00</option><option>14:00</option><option>15:00</option><option>16:00</option>
          </select>
        </div>
      </div>
      <div class="mt">
        <label class="small">Subject</label>
        <input id="subject" class="input" placeholder="e.g. Mathematics">
      </div>
      <div class="mt">
        <label class="small">Room</label>
        <input id="room" class="input" placeholder="e.g. 101 or Online">
      </div>
      <div class="row mt" style="justify-content:flex-end">
        <button class="btn" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="saveSlot()">Save Class</button>
      </div>
    </div>
  </div>

  <script>
    const ACTIVE_SESSION_KEY = 'gearhub_active_session';
    const user = JSON.parse(localStorage.getItem(ACTIVE_SESSION_KEY) || 'null');
    if (!user) location.href='login.html';
    function logout(){ localStorage.removeItem(ACTIVE_SESSION_KEY); location.href='login.html'; }

    const WEEKDAYS = ['Mon','Tue','Wed','Thu','Fri'];
    const HOURS = ['09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00'];
    const STORAGE_KEY = `gearhub_timetable_${user.id}`;
    let slots = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

    function renderGrid(){
      const g = document.getElementById('grid');
      g.innerHTML = '';
      // Header row
      const headerRow = document.createElement('div');
      headerRow.style.display='contents';
      const timeHead = cell('Time','header-cell'); g.appendChild(timeHead);
      WEEKDAYS.forEach(d=>g.appendChild(cell(d,'header-cell')));
      // Rows
      HOURS.forEach(hour=>{
        const timeCell = cell(hour); g.appendChild(timeCell);
        WEEKDAYS.forEach(day=>{
          const c = document.createElement('div'); c.className='cell';
          const slot = slots.find(s=>s.day===day && s.time===hour);
          if (slot) {
            const s = document.createElement('div'); s.className='slot';
            s.innerHTML = `<div><strong>${slot.subject}</strong></div><div class="small">${slot.room}</div>`;
            s.onclick = () => { if(confirm('Delete this class?')) { slots = slots.filter(x=>x.id!==slot.id); saveLocal(); renderGrid(); } };
            c.appendChild(s);
          } else {
            c.onclick = () => { document.getElementById('day').value=day; document.getElementById('time').value=hour; openModal(); };
          }
          g.appendChild(c);
        });
      });
    }
    function cell(text, extra='cell'){ const el=document.createElement('div'); el.className=extra; el.textContent=text; return el; }
    function openModal(){ document.getElementById('modal').style.display='flex'; }
    function closeModal(){ document.getElementById('modal').style.display='none'; }
    function saveLocal(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(slots)); }
    function saveSlot(){
      const day = document.getElementById('day').value;
      const time = document.getElementById('time').value;
      const subject = document.getElementById('subject').value.trim();
      const room = document.getElementById('room').value.trim();
      if(!day || !time || !subject || !room) return alert('Fill all fields.');
      const slot = { id: Date.now().toString(), day, time, subject, room, color:'bg-blue-500' };
      slots = slots.filter(s=>!(s.day===day && s.time===time));
      slots.push(slot); saveLocal(); closeModal(); renderGrid();
    }

    renderGrid();
  </script>
</body>
</html>
